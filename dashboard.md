# 대시보드 MVP 사양

## 맥락
- MVP는 자동 스팸 탐지와 자동 삭제만 지원하며, 수동 검수 기능은 포함하지 않습니다.
- YouTube API 제약으로 인해 한 번 삭제된 댓글은 복구할 수 없습니다.

## 핵심 대시보드 콘텐츠
- **KPI 카드 스트립**: 오늘 자동 삭제 수, 오늘 탐지 수, 누적 자동 삭제 수, 누적 탐지 수. 각 카드에 전일 대비 증감률을 배지로 표시합니다.
- **실행 상태 카드**: 마지막 탐지 실행 시각, 다음 예정 실행 시각, 최근 3회 실행 로그와 성공/오류 여부를 요약합니다.
- **추세 그래프**: 최근 14일 동안의 탐지 수와 삭제 수를 라인 차트로 비교하고 평균 기준선과 일/주/월 기간 토글을 제공합니다.
- **채널 분포 테이블**: 연결된 채널 목록, 오늘/누적 탐지·삭제 수, 채널 상태(오류, 비활성 등) 태그, 검색/필터 기능을 제공합니다.
- **최근 스팸 활동 피드**: 자동으로 삭제된 댓글 스니펫, 채널명, 트리거 규칙, 삭제 시각, “복구 불가” 안내 배지를 나열합니다.
- **알림 및 위험 카드**: API 토큰 만료 임박, 삭제 실패, 탐지 지연 등 고우선 경고를 요약하고 상세 조치로 이동하는 링크를 제공합니다.
- **시스템 스냅샷 카드**: 연결된 채널 수, 활성 탐지 규칙 수, 알림 채널 상태를 요약하고 각 항목을 설정 화면으로 연결합니다.

## KPI 정의 및 데이터 갱신 주기
- 기준 시간대: 워크스페이스 표준 시간대(기본값 UTC). “오늘” 범위는 00:00~23:59, “전일”은 직전 하루입니다.
- 전일 대비 증감률: `(오늘 값 - 전일 값) / 전일 값 * 100`. 전일 값이 0일 경우 증감률은 “—”로 표시합니다.

| KPI | 정의 | 계산 로직 | 주요 데이터 소스 | 갱신 주기 | 비고 |
| --- | --- | --- | --- | --- | --- |
| 오늘 자동 삭제 수 | 금일 00:00 이후 자동화가 성공적으로 삭제한 댓글 수 | `COUNT(*)` where `event_type = AUTO_DELETE` `AND status = SUCCESS` `AND executed_at BETWEEN start_of_day AND now` | 스팸 처리 서비스 이벤트 로그 → 일별 삭제 집계 뷰 (`metrics_auto_delete_daily`) | 이벤트 발생 시 실시간으로 증가, 메트릭 API는 60초 캐시 | 삭제 실패 건은 제외되며 알림 카드에서 별도 추적 |
| 오늘 탐지 수 | 금일 00:00 이후 자동 탐지된 댓글 수 (삭제 성공 여부 무관) | `COUNT(DISTINCT detection_event_id)` where `detected_at BETWEEN start_of_day AND now` | 탐지 엔진 이벤트 로그 → 일별 탐지 집계 뷰 (`metrics_detection_daily`) | 이벤트 발생 시 실시간 집계, 60초 캐시 | 숨김/보류 상태 포함, 중복 탐지 방지를 위해 코멘트 ID 기준 dedupe |
| 누적 자동 삭제 수 | 워크스페이스 생성 이후 자동으로 삭제 완료된 댓글 총합 | `SUM(daily_auto_delete_count)` over 전체 기간 | 장기 보관용 롤업 테이블 (`metrics_auto_delete_lifetime`) | 매 5분마다 롤업 동기화 | 계정 연결/해제와 무관하게 워크스페이스 기준으로 누적 |
| 누적 탐지 수 | 워크스페이스 생성 이후 자동으로 탐지된 댓글 총합 | `SUM(daily_detection_count)` over 전체 기간 | 장기 보관용 롤업 테이블 (`metrics_detection_lifetime`) | 매 5분마다 롤업 동기화 | 탐지 후 삭제 실패/성공 여부와 관계없이 카운트 |

## 와이어프레임 레이아웃 (12열 그리드)
- **헤더(전폭)**: 왼쪽에 제품명과 환경 배지, 오른쪽에 계정 전환, 알림, 도움말 아이콘을 배치합니다.
- **1행**: KPI 카드를 4개 배치해 12열을 채우고, 데스크톱에서는 카드당 3열, 모바일에서는 2열씩 배치합니다.
- **2행**: 왼쪽 8열에 추세 그래프 카드를, 오른쪽 4열에 실행 상태 카드를 배치합니다.
- **3행**: 왼쪽 7열에 채널 분포 테이블, 오른쪽 5열에 알림 및 위험 카드를 배치합니다.
- **4행**: 왼쪽 7열에 최근 스팸 활동 피드, 오른쪽 5열에 시스템 스냅샷 카드를 배치합니다.
- **푸터**: 로그, 문서, 정책 관련 링크를 제공합니다.

## 즉각적인 다음 단계
1. ~~KPI 정의와 데이터 갱신 주기를 확정합니다.~~ (완료)
2. 탐지·삭제·스케줄러 로그·채널 메타데이터 API 엔드포인트를 검증하고 계약을 문서화합니다.
3. KPI 카드, 추세 그래프, 테이블, 활동 피드를 위한 고충실(Figma) 와이어프레임을 제작합니다.
4. 각 위험 시나리오에 대한 알림 임계치와 문구를 정의하고 알림 채널 매핑을 완성합니다.
5. 데이터 집계 작업과 대시보드 로드 성능 목표를 엔지니어링 팀과 조율합니다.
